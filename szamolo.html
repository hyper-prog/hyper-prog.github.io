<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//Hu" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="HU" lang="HU" dir="ltr">
<head>
    <title>Feladatgeneralas</title>
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<style type="text/css">
    #out_area {
        font-size: large;
        font-family: 'Courier New', Courier, monospace;
        line-height: 1.6;
        font-weight: bold;
    }
</style>
</head>
<body>
    <h3>Összeadás, kivonás</h3>
    <a href="szamolo2.html">Szorzás, osztás</a>
    <br/><br/>
    <table>
        <tr><td>Darabszám</td><td><input id="in_darab" type="number" value="30"/></td></tr>
        <tr><td>Legnagyobb szám</td><td><input id="in_max" type="number" value="20"/></td></tr>
        <tr><td>Triviálisak kiszűrése</td><td><input type="checkbox" id="in_skiptriv"></td></tr>
        <tr><td>Űrlapos változat</td><td><input type="checkbox" id="in_webform"></td></tr>
        <tr><td colspan="2">
            <button id="in_gen">Generál</button>
            <button id="in_check">Ellenőriz</button>
        </td></tr>
    </table>
    <div id="out_area">

    </div>
    <script>
        jQuery(document).ready(function() {
            jQuery("#in_gen").click(function() {
                var out = "";
                jQuery('#in_check').prop('disabled', false);
                var max = parseInt(jQuery("#in_max").val());
                var cnt = parseInt(jQuery("#in_darab").val());
                var triv = jQuery('#in_skiptriv').is(":checked");
                var webform = jQuery('#in_webform').is(":checked");
                var o1,o2,m,r,t;
                if(!webform)
                    jQuery('#in_check').prop('disabled', true);
                for(i=0;i<cnt;++i)
                {
                    m = (Math.floor(Math.random() * 100) % 2) ? '+' : '-';
                    do
                    {
                        o1 = Math.floor(Math.random() * 10000) %  (max + 1);
                        o2 = Math.floor(Math.random() * 10000) %  (max + 1);
                        r = (m == '+' ? o1 + o2 : o1 - o2);
                    }
                    while((m == '-' && o2 > o1) || (o1 == 0 && o2 == 0) || (m == '+' && (o2+o1) > max ) ||
                          (triv && (o1 < 2 || o2 < 2 || r < 2)));
                    t = Math.floor(Math.random() * 100) % 3;

                    pholder_r = '__';
                    pholder_c = '';
                    if(webform)
                    {
                        pholder_r = '<input type="text" id="qv_'+i+'" value="" maxwidth="3" size="3">';
                        pholder_c = '<span id="qc_'+i+'"></span>';
                    }

                    if(t==0)
                        out += o1 + ' ' + m + ' ' + o2 + ' = ' + pholder_r + pholder_c + 
                               '<input type="hidden" id="qh_'+i+'" value="' + r*1171 + '"/>' +
                               '<br/>';
                    if(t==1)
                        out += o1 + ' ' + m + ' ' + pholder_r + ' = ' + r + pholder_c + 
                               '<input type="hidden" id="qh_'+i+'" value="' + o2*1171 + '"/>' +
                               '<br/>';
                    if(t==2)
                        out += pholder_r +' ' + m + ' ' + o2 + ' = ' + r + pholder_c + 
                               '<input type="hidden" id="qh_'+i+'" value="' + o1*1171 + '"/>' +
                               '<br/>';
                }
                
                jQuery("#out_area").html(out);
            });
            jQuery("#in_check").click(function() {
                var out = "";
                var cnt = parseInt(jQuery("#in_darab").val());
                for(i=0;i<cnt;++i)
                {
                    v = jQuery('#qv_'+i).val();
                    if(v == '' || v == undefined)
                    {
                        alert('Csak akkor ellenőrizhető a feladatsor, ha minden feladat meg van oldva!');
                        return;
                    }
                }
                jQuery('#in_check').prop('disabled', true);
                for(i=0;i<cnt;++i)
                {
                    h = jQuery('#qh_'+i).val();
                    v = jQuery('#qv_'+i).val();

                    if(v != '' && v != undefined && v == (h/1171))
                        jQuery('#qc_'+i).html('<font color="#44ff44;"> Helyes!</font>');
                    else
                        jQuery('#qc_'+i).html('<font color="#ff4444;"> Helytelen!</font>');
                }
            });

        });
        
    </script>
</body>
</html>