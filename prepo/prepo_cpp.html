<html>
<head>
<title>HTML code generated by "CPP to HTML Coder"</title>
<style>
body
{
   font-family: verdana;
   font-size: 15px;
   color: black;
}

B
{
   font-family: verdana;
   font-size: 11px;
}

table
{
   font-family: verdana;
   font-size: 15px;
   color: black;
}

pre.C_CPP_file
{
   background-color: silver;
   color: black;
   border-bottom: black 1px solid;
   border-left: black 1px solid;
   border-right: black 1px solid;
   border-top: black 1px solid;
   margin-left: auto;
   margin-right: auto;
   padding-bottom; 3px;
   padding-left: 3px;
   padding-right: 3px;
   padding-top: 3px;
   font-family: courier;
   font-size: 9pt;
   text-align: left;
}
</style>
</head>
<body bgcolor=#eeeeee text=#000000 link=#888888 alink=#888888 vlink=#888888>
<table cellpadding=10><tr><td>
<pre class=C_CPP_file>
<font color="#007766">/*
   pRepo - Peter's Repository program
        Complex tutorial of gSAFE ( http://hyperprog.com/gsafe/ )

   (C) 2011 Peter Deak  (______@gmail.com)

   License: GPL

*/</font>

<font color="#c300c3">#include </font><font color="#333399">&lt;</font>QtCore<font color="#333399">&gt;</font>
<font color="#c300c3">#include </font><font color="#333399">&lt;</font>QtSql<font color="#333399">&gt;</font>
<font color="#c300c3">#include </font><font color="#333399">&lt;</font>QtGui<font color="#333399">&gt;</font>
<font color="#c300c3">#include </font><font color="#333399">&lt;</font>QtWebKit<font color="#333399">&gt;</font>

<font color="#c300c3">#include </font><font color="#333399">&lt;</font>datalib<font size=3 color="#333399">.</font>h<font color="#333399">&gt;</font>
<font color="#c300c3">#include </font><font color="#333399">&lt;</font>hfactory<font size=3 color="#333399">.</font>h<font color="#333399">&gt;</font>
<font color="#c300c3">#include </font><font color="#333399">&lt;</font>dialib<font size=3 color="#333399">.</font>h<font color="#333399">&gt;</font>
<font color="#c300c3">#include </font><font color="#333399">&lt;</font>dconsole<font size=3 color="#333399">.</font>h<font color="#333399">&gt;</font>
<font color="#c300c3">#include </font><font color="#333399">&lt;</font>guilib<font size=3 color="#333399">.</font>h<font color="#333399">&gt;</font>
<font color="#c300c3">#include </font><font color="#333399">&lt;</font>printlib<font size=3 color="#333399">.</font>h<font color="#333399">&gt;</font>
<font color="#c300c3">#include </font><font color="#333399">&lt;</font>xmlolib<font size=3 color="#333399">.</font>h<font color="#333399">&gt;</font>

<font color="#c300c3">#include </font><font color="#ff00bf">"prepo.h"</font>

<font color="#007766">// ////////////////////////////////////////////////////////////////////////////////////////////
</font>
MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>MainDialog<font size=3 color="#333399">(</font>QWidget <font size=3 color="#333399">*</font>parent<font size=3 color="#333399">)</font>
    <font size=3 color="#333399">:</font> QDialog<font size=3 color="#333399">(</font>parent<font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>ui<font size=3 color="#333399">(</font><font color="#553399"><b>new</font></b> Ui<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>MainWindowBase<font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    ui<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>setupUi<font size=3 color="#333399">(</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    HSqlInterface<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>setSqlMode<font size=3 color="#333399">(</font><font color="#ff00bf">"QtSqlite_Win"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    <font color="#007766">//Initialize HRefreshAgent...
</font>
    <font color="#553399"><b>new</font></b> HRefreshAgent<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    <font color="#007766">//Create HFactory object...
</font>
    myfactory <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> HFactory<font size=3 color="#333399">(</font><font color="#ff00bf">""</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>myfactory<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>errorSignal<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>showError<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    <font color="#007766">//Read metadata from Qt resource by HFactory
</font>
    QFile <font size=3 color="#333399">*</font>metadatadef_file<font size=3 color="#333399">=</font>NULL<font size=3 color="#333399">;</font>
    metadatadef_file <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> QFile<font size=3 color="#333399">(</font>METADEFFILE<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font><font size=3 color="#333399">!</font>metadatadef_file<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>exists<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        error<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Error: Missing datadef file!"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        exit<font size=3 color="#333399">(</font><font color="c30000"><b>0</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>
    myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>readFromFile<font size=3 color="#333399">(</font>metadatadef_file<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> metadatadef_file<font size=3 color="#333399">;</font>
    metadatadef_file <font size=3 color="#333399">=</font> NULL<font size=3 color="#333399">;</font>

    <font color="#007766">//Opens the database, or create if not exists
</font>
    sdebug<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">(</font><font color="#ff00bf">"Open the sqlite database file:"</font><font size=3 color="#333399">)</font> <font size=3 color="#333399">+</font> QString<font size=3 color="#333399">(</font>DATABASEFILE<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>bool</font></b> newcreate<font size=3 color="#333399">=</font><font color="#553399"><b>false</font></b><font size=3 color="#333399">;</font>
    QFile <font size=3 color="#333399">*</font>database_file<font size=3 color="#333399">=</font>NULL<font size=3 color="#333399">;</font>
    database_file <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> QFile<font size=3 color="#333399">(</font>DATABASEFILE<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font><font size=3 color="#333399">!</font>database_file<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>exists<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        error<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Error:Can't open the database file!"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>QMessageBox<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>question<font size=3 color="#333399">(</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"New database"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Create new empty database structure?"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"No"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Yes"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
            newcreate <font size=3 color="#333399">=</font> <font color="#553399"><b>true</font></b><font size=3 color="#333399">;</font>

        <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font><font size=3 color="#333399">!</font>newcreate<font size=3 color="#333399">)</font>
            exit<font size=3 color="#333399">(</font><font color="c30000"><b>0</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>
    <font color="#553399"><b>delete</font></b> database_file<font size=3 color="#333399">;</font>
    database_file <font size=3 color="#333399">=</font> NULL<font size=3 color="#333399">;</font>

    QSqlDatabase db <font size=3 color="#333399">=</font> QSqlDatabase<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>addDatabase<font size=3 color="#333399">(</font><font color="#ff00bf">"QSQLITE"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    db<font size=3 color="#333399">.</font>setDatabaseName<font size=3 color="#333399">(</font>DATABASEFILE<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font><font size=3 color="#333399">!</font>db<font size=3 color="#333399">.</font>open<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        QMessageBox<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>information<font size=3 color="#333399">(</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font><font color="#ff00bf">"gSAFE-Qt4"</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Cannot establish the database connection..."</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        exit<font size=3 color="#333399">(</font><font color="c30000"><b>0</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>

    globalsql <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> HSqlHandler<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>globalsql<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>errorSignal<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>showError<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    <font color="#007766">//Create the database structure
</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>newcreate<font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        QString createstr<font size=3 color="#333399">=</font><font color="#ff00bf">""</font><font size=3 color="#333399">;</font>
        <font color="#007766">//Creating a new empty database structure...
</font>

        createstr <font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>sqlCreateString<font size=3 color="#333399">(</font><font color="#ff00bf">"settings"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit0ResultQuery<font size=3 color="#333399">(</font>createstr<font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Error during structure creation (0)"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        createstr <font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>sqlCreateString<font size=3 color="#333399">(</font><font color="#ff00bf">"Type"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit0ResultQuery<font size=3 color="#333399">(</font>createstr<font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Error during structure creation (1)"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        createstr <font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>sqlCreateString<font size=3 color="#333399">(</font><font color="#ff00bf">"Place"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit0ResultQuery<font size=3 color="#333399">(</font>createstr<font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Error during structure creation (2)"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        createstr <font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>sqlCreateString<font size=3 color="#333399">(</font><font color="#ff00bf">"Accountable"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit0ResultQuery<font size=3 color="#333399">(</font>createstr<font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Error during structure creation (3)"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        createstr <font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>sqlCreateString<font size=3 color="#333399">(</font><font color="#ff00bf">"Object"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit0ResultQuery<font size=3 color="#333399">(</font>createstr<font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Error during structure creation (4)"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        createstr <font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>sqlCreateString<font size=3 color="#333399">(</font><font color="#ff00bf">"Moving"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit0ResultQuery<font size=3 color="#333399">(</font>createstr<font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Error during structure creation (5)"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

        <font color="#007766">//Popus a dialog to save the settings (insert a record to the setting table
</font>
        HTable <font size=3 color="#333399">*</font>settings <font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>genHTable<font size=3 color="#333399">(</font><font color="#ff00bf">"settings"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        HDialog <font size=3 color="#333399">*</font>fsdialog <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> HDialog<font size=3 color="#333399">(</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Settings"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>settings<font size=3 color="#333399">,</font>NULL<font size=3 color="#333399">,</font><font color="#ff00bf">"Ok|OkIsAccept|StrToE"</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Set the following attributes"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        <font color="#553399"><b>while</font></b><font size=3 color="#333399">(</font><font size=3 color="#333399">!</font>fsdialog<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>exec<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        settings<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>setSqlFieldValue<font size=3 color="#333399">(</font><font color="#ff00bf">"next"</font><font size=3 color="#333399">,</font>settings<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>getSqlFieldValue<font size=3 color="#333399">(</font><font color="#ff00bf">"start"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        settings<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>insertRecord<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        <font color="#553399"><b>delete</font></b> fsdialog<font size=3 color="#333399">;</font>
        <font color="#553399"><b>delete</font></b> settings<font size=3 color="#333399">;</font>

    <font size=3 color="#333399">}</font>
    <font color="#007766">//Database succesfull opened...
</font>

    objectchangelogger <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> HDataChangeLogger<font size=3 color="#333399">(</font>myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>genHTable<font size=3 color="#333399">(</font><font color="#ff00bf">"Moving"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#ff00bf">"Unknown"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"User"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#007766">//------------- Allocate various things --------------------------------------
</font>

    pixmaparray_new_edit_del <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> QList<font color="#333399">&lt;</font>QPixmap <font size=3 color="#333399">*</font><font color="#333399">&gt;</font><font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        pixmaparray_new_edit_del<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>push_back<font size=3 color="#333399">(</font><font color="#553399"><b>new</font></b> QPixmap<font size=3 color="#333399">(</font><font color="#ff00bf">":/ICONS/new.png"</font> <font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        pixmaparray_new_edit_del<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>push_back<font size=3 color="#333399">(</font><font color="#553399"><b>new</font></b> QPixmap<font size=3 color="#333399">(</font><font color="#ff00bf">":/ICONS/edit.png"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        pixmaparray_new_edit_del<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>push_back<font size=3 color="#333399">(</font><font color="#553399"><b>new</font></b> QPixmap<font size=3 color="#333399">(</font><font color="#ff00bf">":/ICONS/del.png"</font> <font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    connect<font size=3 color="#333399">(</font>ui<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>bClose<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>close<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>ui<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>bObjects<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotObjects<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>ui<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>bTypes<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotTypes<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>ui<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>bPlaces<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotPlaces<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>ui<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>bAcc<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotAcc<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    connect<font size=3 color="#333399">(</font>ui<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>bIn<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotInObj<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>ui<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>bMove<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotMoveObj<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>ui<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>bSetprice<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotSetCValueObj<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>ui<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>bOut<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotOutObj<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>ui<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>bTrace<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotTraceObj<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    connect<font size=3 color="#333399">(</font>ui<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>bConsole<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotConsole<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>ui<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>bAbout<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotInfo<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    currList <font size=3 color="#333399">=</font> NULL<font size=3 color="#333399">;</font>
    objt <font size=3 color="#333399">=</font> NULL<font size=3 color="#333399">;</font>
    clicked_outkey <font size=3 color="#333399">=</font> <font color="#ff00bf">""</font><font size=3 color="#333399">;</font>
    wstack<font size=3 color="#333399">.</font>clear<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    wstack<font size=3 color="#333399">.</font>push_back<font size=3 color="#333399">(</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    setSizeGripEnabled<font size=3 color="#333399">(</font><font color="#553399"><b>true</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    slotStat<font size=3 color="#333399">(</font><font color="#ff00bf">""</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    connect<font size=3 color="#333399">(</font>HRefreshAgent<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>getNotifyAgent<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>getnotify<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotStat<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    <font color="#007766">//Register custom console commands
</font>
    <font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>register_dconsole_command<font size=3 color="#333399">(</font><font color="#ff00bf">"createstr"</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>register_dconsole_command<font size=3 color="#333399">(</font><font color="#ff00bf">"dumpmetadata"</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font><font size=3 color="#333399">~</font>MainDialog<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
<font size=3 color="#333399">}</font>

<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>showError<font size=3 color="#333399">(</font>QString err<font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    QString msg<font size=3 color="#333399">;</font>
    msg <font size=3 color="#333399">=</font> QString<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"%1: %2"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
            <font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Error received"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
            <font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>err<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    sdebug<font size=3 color="#333399">(</font>msg<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    error<font size=3 color="#333399">(</font>msg<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotConsole<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    dconsole<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotInfo<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    QMessageBox<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>information<font size=3 color="#333399">(</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"About"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>
        QString<font size=3 color="#333399">(</font><font color="#ff00bf">"&lt;strong&gt;pRepo&lt;/strong&gt; - %1&lt;br&gt;%2&lt;br&gt;http://hyperprog.com&lt;br&gt;&lt;br&gt;%3: %4&lt;br&gt;gSAFE: %5&lt;br&gt;&lt;br&gt;%6&lt;br&gt;License: GPLv2"</font><font size=3 color="#333399">)</font>
            <font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Peter's repository program"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
            <font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"(gSAFE tutorial program)"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
            <font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Version"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
            <font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>VERSION<font size=3 color="#333399">)</font>
            <font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>GSAFE_VERSION<font size=3 color="#333399">)</font>
            <font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Author: Peter Deak (hyper80@gmail.com)"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#007766">// //Places///////////////////////////////////////////////////////////////////////
</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotPlaces<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    currList <font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>genHList<font size=3 color="#333399">(</font><font color="#ff00bf">"Place"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"list"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    currList<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>extrafeatures <font size=3 color="#333399">=</font> <font color="#553399"><b>true</font></b><font size=3 color="#333399">;</font>

    HDialog <font size=3 color="#333399">*</font>d <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> HDialog<font size=3 color="#333399">(</font>wstack<font size=3 color="#333399">.</font>top<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Places"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>currList<font size=3 color="#333399">,</font>NULL<font size=3 color="#333399">,</font>
                             <font color="#ff00bf">"Ok|EscC|ToolCenter|Vert"</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Places"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#ff00bf">""</font><font size=3 color="#333399">,</font><font color="#ff00bf">""</font><font size=3 color="#333399">,</font>pixmaparray_new_edit_del<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    currList<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>readList<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>currList<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>actionOnRecord<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotPlacesAct<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>pixTool<font size=3 color="#333399">[</font><font color="c30000"><b>0</font></b><font size=3 color="#333399">]</font><font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotAddPlaces<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>pixTool<font size=3 color="#333399">[</font><font color="c30000"><b>1</font></b><font size=3 color="#333399">]</font><font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotEditPlaces<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>pixTool<font size=3 color="#333399">[</font><font color="c30000"><b>2</font></b><font size=3 color="#333399">]</font><font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotDelPlace<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    wstack<font size=3 color="#333399">.</font>push_back<font size=3 color="#333399">(</font>d<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>exec<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    wstack<font size=3 color="#333399">.</font>pop<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> d<font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> currList<font size=3 color="#333399">;</font>
    currList <font size=3 color="#333399">=</font> NULL<font size=3 color="#333399">;</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotAddPlaces<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    HTable <font size=3 color="#333399">*</font>t <font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>genHTable<font size=3 color="#333399">(</font><font color="#ff00bf">"Place"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    HDialog <font size=3 color="#333399">*</font>d <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> HDialog<font size=3 color="#333399">(</font>wstack<font size=3 color="#333399">.</font>top<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"A new place"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>t<font size=3 color="#333399">,</font>NULL<font size=3 color="#333399">,</font>
                             <font color="#ff00bf">"Ok|EscC|Vert|StrToE|OkIsAccept"</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"The new place"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    wstack<font size=3 color="#333399">.</font>push_back<font size=3 color="#333399">(</font>d<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>while</font></b><font size=3 color="#333399">(</font>d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>exec<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        t<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>rereadNextInsertedKey<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>t<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>insertRecord<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font> <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> <font color="c30000"><b>0</font></b><font size=3 color="#333399">)</font>
        <font size=3 color="#333399">{</font>
            emit setKeyTo<font size=3 color="#333399">(</font>t<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>getInsertedKey<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
            HRefreshAgent<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>notify<font size=3 color="#333399">(</font><font color="#ff00bf">"place"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
            <font color="#553399"><b>break</font></b><font size=3 color="#333399">;</font>
        <font size=3 color="#333399">}</font>
        <font color="#553399"><b>else</font></b> <font color="#553399"><b>continue</font></b><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>
    wstack<font size=3 color="#333399">.</font>pop<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> d<font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> t<font size=3 color="#333399">;</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotEditPlaces<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    QString key<font size=3 color="#333399">;</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>currList <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> NULL <font size=3 color="#333399">|</font><font size=3 color="#333399">|</font> currList<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>soft_current_key<font size=3 color="#333399">.</font>isEmpty<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
        <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
    key <font size=3 color="#333399">=</font> currList<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>soft_current_key<font size=3 color="#333399">;</font>
    HTable <font size=3 color="#333399">*</font>t <font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>genHTable<font size=3 color="#333399">(</font><font color="#ff00bf">"Place"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    HDialog <font size=3 color="#333399">*</font>d <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> HDialog<font size=3 color="#333399">(</font>wstack<font size=3 color="#333399">.</font>top<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Edit place"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>t<font size=3 color="#333399">,</font>NULL<font size=3 color="#333399">,</font>
                             <font color="#ff00bf">"Ok|EscC|Vert|StrToE|OkIsAccept"</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Edit the place"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    t<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>updateWithKey<font size=3 color="#333399">(</font>key<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    wstack<font size=3 color="#333399">.</font>push_back<font size=3 color="#333399">(</font>d<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>while</font></b><font size=3 color="#333399">(</font>d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>exec<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>t<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>saveRecord<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font> <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> <font color="c30000"><b>0</font></b><font size=3 color="#333399">)</font>
        <font size=3 color="#333399">{</font>
            HRefreshAgent<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>notify<font size=3 color="#333399">(</font><font color="#ff00bf">"place"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
            <font color="#553399"><b>break</font></b><font size=3 color="#333399">;</font>
        <font size=3 color="#333399">}</font>
        <font color="#553399"><b>else</font></b> <font color="#553399"><b>continue</font></b><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>
    wstack<font size=3 color="#333399">.</font>pop<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> d<font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> t<font size=3 color="#333399">;</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotDelPlace<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    QString key<font size=3 color="#333399">;</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>currList <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> NULL <font size=3 color="#333399">|</font><font size=3 color="#333399">|</font> currList<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>soft_current_key<font size=3 color="#333399">.</font>isEmpty<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
        <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
    key <font size=3 color="#333399">=</font> currList<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>soft_current_key<font size=3 color="#333399">;</font>

    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>QMessageBox<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>question<font size=3 color="#333399">(</font>wstack<font size=3 color="#333399">.</font>top<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Are you sure?"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Are you sure want to delete this place?"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"No"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Yes"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit1ResultQuery<font size=3 color="#333399">(</font>
                QString<font size=3 color="#333399">(</font><font color="#ff00bf">"SELECT COUNT(*) FROM object WHERE place=\'%1\';"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>key<font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#ff00bf">"CL01"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>toInt<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font> <font color="#333399">&gt;</font> <font color="c30000"><b>0</font></b><font size=3 color="#333399">)</font>
        <font size=3 color="#333399">{</font>
            error<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"You can't delete a place which contains objects! Sorry."</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
            <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
        <font size=3 color="#333399">}</font>
        globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit0ResultQuery<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">(</font><font color="#ff00bf">"DELETE FROM place WHERE pkey=%1"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>key<font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#ff00bf">""</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        HRefreshAgent<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>notify<font size=3 color="#333399">(</font><font color="#ff00bf">"place"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#007766">// //Types///////////////////////////////////////////////////////////////////////
</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotTypes<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    currList <font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>genHList<font size=3 color="#333399">(</font><font color="#ff00bf">"Type"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"list"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    currList<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>extrafeatures <font size=3 color="#333399">=</font> <font color="#553399"><b>true</font></b><font size=3 color="#333399">;</font>

    HDialog <font size=3 color="#333399">*</font>d <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> HDialog<font size=3 color="#333399">(</font>wstack<font size=3 color="#333399">.</font>top<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Types"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>currList<font size=3 color="#333399">,</font>NULL<font size=3 color="#333399">,</font>
                             <font color="#ff00bf">"Ok|EscC|ToolCenter|Vert"</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Types"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#ff00bf">""</font><font size=3 color="#333399">,</font><font color="#ff00bf">""</font><font size=3 color="#333399">,</font>pixmaparray_new_edit_del<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    currList<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>readList<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>currList<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>actionOnRecord<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotTypesAct<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>pixTool<font size=3 color="#333399">[</font><font color="c30000"><b>0</font></b><font size=3 color="#333399">]</font><font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotAddTypes<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>pixTool<font size=3 color="#333399">[</font><font color="c30000"><b>1</font></b><font size=3 color="#333399">]</font><font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotEditTypes<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>pixTool<font size=3 color="#333399">[</font><font color="c30000"><b>2</font></b><font size=3 color="#333399">]</font><font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotDelTypes<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    wstack<font size=3 color="#333399">.</font>push_back<font size=3 color="#333399">(</font>d<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>exec<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    wstack<font size=3 color="#333399">.</font>pop<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> d<font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> currList<font size=3 color="#333399">;</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotAddTypes<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    HTable <font size=3 color="#333399">*</font>t <font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>genHTable<font size=3 color="#333399">(</font><font color="#ff00bf">"Type"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    HDialog <font size=3 color="#333399">*</font>d <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> HDialog<font size=3 color="#333399">(</font>wstack<font size=3 color="#333399">.</font>top<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"A new type"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>t<font size=3 color="#333399">,</font>NULL<font size=3 color="#333399">,</font>
                             <font color="#ff00bf">"Ok|EscC|Vert|StrToE|OkIsAccept"</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"The new type"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    wstack<font size=3 color="#333399">.</font>push_back<font size=3 color="#333399">(</font>d<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>while</font></b><font size=3 color="#333399">(</font>d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>exec<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        t<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>rereadNextInsertedKey<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>t<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>insertRecord<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font> <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> <font color="c30000"><b>0</font></b><font size=3 color="#333399">)</font>
        <font size=3 color="#333399">{</font>
            emit setKeyTo<font size=3 color="#333399">(</font>t<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>getInsertedKey<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
            HRefreshAgent<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>notify<font size=3 color="#333399">(</font><font color="#ff00bf">"type"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
            <font color="#553399"><b>break</font></b><font size=3 color="#333399">;</font>
        <font size=3 color="#333399">}</font>
        <font color="#553399"><b>else</font></b> <font color="#553399"><b>continue</font></b><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>
    wstack<font size=3 color="#333399">.</font>pop<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> d<font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> t<font size=3 color="#333399">;</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotEditTypes<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    QString key<font size=3 color="#333399">;</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>currList <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> NULL <font size=3 color="#333399">|</font><font size=3 color="#333399">|</font> currList<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>soft_current_key<font size=3 color="#333399">.</font>isEmpty<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
        <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
    key <font size=3 color="#333399">=</font> currList<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>soft_current_key<font size=3 color="#333399">;</font>
    HTable <font size=3 color="#333399">*</font>t <font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>genHTable<font size=3 color="#333399">(</font><font color="#ff00bf">"Type"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    HDialog <font size=3 color="#333399">*</font>d <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> HDialog<font size=3 color="#333399">(</font>wstack<font size=3 color="#333399">.</font>top<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Edit type"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>t<font size=3 color="#333399">,</font>NULL<font size=3 color="#333399">,</font>
                             <font color="#ff00bf">"Ok|EscC|Vert|StrToE|OkIsAccept"</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Edit the type"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    t<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>updateWithKey<font size=3 color="#333399">(</font>key<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    wstack<font size=3 color="#333399">.</font>push_back<font size=3 color="#333399">(</font>d<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>while</font></b><font size=3 color="#333399">(</font>d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>exec<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>t<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>saveRecord<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font> <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> <font color="c30000"><b>0</font></b><font size=3 color="#333399">)</font>
        <font size=3 color="#333399">{</font>
            HRefreshAgent<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>notify<font size=3 color="#333399">(</font><font color="#ff00bf">"type"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
            <font color="#553399"><b>break</font></b><font size=3 color="#333399">;</font>
        <font size=3 color="#333399">}</font>
        <font color="#553399"><b>else</font></b> <font color="#553399"><b>continue</font></b><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>
    wstack<font size=3 color="#333399">.</font>pop<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> d<font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> t<font size=3 color="#333399">;</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotDelTypes<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    QString key<font size=3 color="#333399">;</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>currList <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> NULL <font size=3 color="#333399">|</font><font size=3 color="#333399">|</font> currList<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>soft_current_key<font size=3 color="#333399">.</font>isEmpty<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
        <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
    key <font size=3 color="#333399">=</font> currList<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>soft_current_key<font size=3 color="#333399">;</font>

    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>QMessageBox<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>question<font size=3 color="#333399">(</font>wstack<font size=3 color="#333399">.</font>top<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Are you sure?"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Are you sure want to delete this type?"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"No"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Yes"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
        <font size=3 color="#333399">{</font>
            <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit1ResultQuery<font size=3 color="#333399">(</font>
                    QString<font size=3 color="#333399">(</font><font color="#ff00bf">"SELECT COUNT(*) FROM object WHERE type=\'%1\';"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>key<font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#ff00bf">"CL01"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>toInt<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font> <font color="#333399">&gt;</font> <font color="c30000"><b>0</font></b><font size=3 color="#333399">)</font>
            <font size=3 color="#333399">{</font>
                error<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"You can't delete a type which contains objects! Sorry."</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
                <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
            <font size=3 color="#333399">}</font>
            globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit0ResultQuery<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">(</font><font color="#ff00bf">"DELETE FROM type WHERE tkey=%1"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>key<font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#ff00bf">""</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
            HRefreshAgent<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>notify<font size=3 color="#333399">(</font><font color="#ff00bf">"type"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        <font size=3 color="#333399">}</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#007766">// //Accountables///////////////////////////////////////////////////////////////////////
</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotAcc<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    currList <font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>genHList<font size=3 color="#333399">(</font><font color="#ff00bf">"Accountable"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"list"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    currList<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>extrafeatures <font size=3 color="#333399">=</font> <font color="#553399"><b>true</font></b><font size=3 color="#333399">;</font>

    HDialog <font size=3 color="#333399">*</font>d <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> HDialog<font size=3 color="#333399">(</font>wstack<font size=3 color="#333399">.</font>top<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Accountables"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>currList<font size=3 color="#333399">,</font>NULL<font size=3 color="#333399">,</font>
                             <font color="#ff00bf">"Ok|EscC|ToolCenter|Vert"</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Accountables"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#ff00bf">""</font><font size=3 color="#333399">,</font><font color="#ff00bf">""</font><font size=3 color="#333399">,</font>pixmaparray_new_edit_del<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    currList<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>readList<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>currList<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>actionOnRecord<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotAccAct<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>pixTool<font size=3 color="#333399">[</font><font color="c30000"><b>0</font></b><font size=3 color="#333399">]</font><font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotAddAcc<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>pixTool<font size=3 color="#333399">[</font><font color="c30000"><b>1</font></b><font size=3 color="#333399">]</font><font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotEditAcc<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>pixTool<font size=3 color="#333399">[</font><font color="c30000"><b>2</font></b><font size=3 color="#333399">]</font><font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>clicked<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotDelAcc<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    wstack<font size=3 color="#333399">.</font>push_back<font size=3 color="#333399">(</font>d<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>exec<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    wstack<font size=3 color="#333399">.</font>pop<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> d<font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> currList<font size=3 color="#333399">;</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotAddAcc<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    HTable <font size=3 color="#333399">*</font>t <font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>genHTable<font size=3 color="#333399">(</font><font color="#ff00bf">"Accountable"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    HDialog <font size=3 color="#333399">*</font>d <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> HDialog<font size=3 color="#333399">(</font>wstack<font size=3 color="#333399">.</font>top<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"A new accountable"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>t<font size=3 color="#333399">,</font>NULL<font size=3 color="#333399">,</font>
                             <font color="#ff00bf">"Ok|EscC|Vert|StrToE|OkIsAccept"</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"The new accountable"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    wstack<font size=3 color="#333399">.</font>push_back<font size=3 color="#333399">(</font>d<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>while</font></b><font size=3 color="#333399">(</font>d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>exec<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        t<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>rereadNextInsertedKey<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>t<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>insertRecord<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font> <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> <font color="c30000"><b>0</font></b><font size=3 color="#333399">)</font>
        <font size=3 color="#333399">{</font>
            emit setKeyTo<font size=3 color="#333399">(</font>t<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>getInsertedKey<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
            HRefreshAgent<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>notify<font size=3 color="#333399">(</font><font color="#ff00bf">"accountable"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
            <font color="#553399"><b>break</font></b><font size=3 color="#333399">;</font>
        <font size=3 color="#333399">}</font>
        <font color="#553399"><b>else</font></b> <font color="#553399"><b>continue</font></b><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>
    wstack<font size=3 color="#333399">.</font>pop<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> d<font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> t<font size=3 color="#333399">;</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotEditAcc<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    QString key<font size=3 color="#333399">;</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>currList <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> NULL <font size=3 color="#333399">|</font><font size=3 color="#333399">|</font> currList<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>soft_current_key<font size=3 color="#333399">.</font>isEmpty<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
        <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
    key <font size=3 color="#333399">=</font> currList<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>soft_current_key<font size=3 color="#333399">;</font>
    HTable <font size=3 color="#333399">*</font>t <font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>genHTable<font size=3 color="#333399">(</font><font color="#ff00bf">"Accountable"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    HDialog <font size=3 color="#333399">*</font>d <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> HDialog<font size=3 color="#333399">(</font>wstack<font size=3 color="#333399">.</font>top<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Edit accountable"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>t<font size=3 color="#333399">,</font>NULL<font size=3 color="#333399">,</font>
                             <font color="#ff00bf">"Ok|EscC|Vert|StrToE|OkIsAccept"</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Edit the accountable"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    t<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>updateWithKey<font size=3 color="#333399">(</font>key<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    wstack<font size=3 color="#333399">.</font>push_back<font size=3 color="#333399">(</font>d<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>while</font></b><font size=3 color="#333399">(</font>d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>exec<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>t<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>saveRecord<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font> <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> <font color="c30000"><b>0</font></b><font size=3 color="#333399">)</font>
        <font size=3 color="#333399">{</font>
            HRefreshAgent<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>notify<font size=3 color="#333399">(</font><font color="#ff00bf">"accountable"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
            <font color="#553399"><b>break</font></b><font size=3 color="#333399">;</font>
        <font size=3 color="#333399">}</font>
        <font color="#553399"><b>else</font></b> <font color="#553399"><b>continue</font></b><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>
    wstack<font size=3 color="#333399">.</font>pop<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> d<font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> t<font size=3 color="#333399">;</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotDelAcc<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    QString key<font size=3 color="#333399">;</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>currList <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> NULL <font size=3 color="#333399">|</font><font size=3 color="#333399">|</font> currList<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>soft_current_key<font size=3 color="#333399">.</font>isEmpty<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
        <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
    key <font size=3 color="#333399">=</font> currList<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>soft_current_key<font size=3 color="#333399">;</font>

    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>QMessageBox<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>question<font size=3 color="#333399">(</font>wstack<font size=3 color="#333399">.</font>top<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Are you sure?"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Are you sure want to delete this accountable?"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"No"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Yes"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
        <font size=3 color="#333399">{</font>
            <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit1ResultQuery<font size=3 color="#333399">(</font>
                    QString<font size=3 color="#333399">(</font><font color="#ff00bf">"SELECT COUNT(*) FROM object WHERE acc=\'%1\';"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>key<font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#ff00bf">"CL01"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>toInt<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font> <font color="#333399">&gt;</font> <font color="c30000"><b>0</font></b><font size=3 color="#333399">)</font>
            <font size=3 color="#333399">{</font>
                error<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"You can't delete an accountable which contains objects! Sorry."</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
                <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
            <font size=3 color="#333399">}</font>
            globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit0ResultQuery<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">(</font><font color="#ff00bf">"DELETE FROM accountable WHERE akey=%1"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>key<font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#ff00bf">""</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
            HRefreshAgent<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>notify<font size=3 color="#333399">(</font><font color="#ff00bf">"accountable"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        <font size=3 color="#333399">}</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#007766">// //Objects///////////////////////////////////////////////////////////////////////
</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotInObj<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font> <font color="#007766">//Add incoming object
</font>
<font size=3 color="#333399">{</font>
    QString repnum<font size=3 color="#333399">;</font>
    <font color="#553399"><b>int</font></b> nextrepnum<font size=3 color="#333399">;</font>

    objt <font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>genHTable<font size=3 color="#333399">(</font><font color="#ff00bf">"Object"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"record"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    <font color="#007766">//Make a new repository number
</font>
    repnum <font size=3 color="#333399">=</font> globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit1ResultQuery<font size=3 color="#333399">(</font><font color="#ff00bf">"SELECT prefix FROM settings LIMIT 1"</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Error query next rep. prefix"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>toString<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    nextrepnum <font size=3 color="#333399">=</font> globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit1ResultQuery<font size=3 color="#333399">(</font><font color="#ff00bf">"SELECT next FROM settings LIMIT 1"</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Error query next rep. num."</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>toInt<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>setSqlFieldValue<font size=3 color="#333399">(</font><font color="#ff00bf">"repnumber"</font><font size=3 color="#333399">,</font>QString<font size=3 color="#333399">(</font><font color="#ff00bf">"%1%2"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>repnum<font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>nextrepnum<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    <font color="#007766">//Check if allow empty accountable
</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font><font size=3 color="#333399">!</font>globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit1ResultQuery<font size=3 color="#333399">(</font><font color="#ff00bf">"SELECT allowemptyacc FROM settings LIMIT 1"</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Error query next settings"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>toBool<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
        objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>fieldBySqlName<font size=3 color="#333399">(</font><font color="#ff00bf">"acc"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">-</font><font color="#333399">&gt;</font>addNotValidValue<font size=3 color="#333399">(</font><font color="#ff00bf">"NULL"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    <font color="#007766">//Add toolbuttons to make possible to add items from here. (type,place,accountable)
</font>
    <font size=3 color="#333399">(</font><font size=3 color="#333399">(</font>HSqlChoose <font size=3 color="#333399">*</font><font size=3 color="#333399">)</font>objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>fieldBySqlName<font size=3 color="#333399">(</font><font color="#ff00bf">"type"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">-</font><font color="#333399">&gt;</font>addToolButton<font size=3 color="#333399">(</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Add new type..."</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">(</font><font size=3 color="#333399">(</font>HSqlChoose <font size=3 color="#333399">*</font><font size=3 color="#333399">)</font>objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>fieldBySqlName<font size=3 color="#333399">(</font><font color="#ff00bf">"place"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">-</font><font color="#333399">&gt;</font>addToolButton<font size=3 color="#333399">(</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Add new place..."</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">(</font><font size=3 color="#333399">(</font>HSqlChoose <font size=3 color="#333399">*</font><font size=3 color="#333399">)</font>objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>fieldBySqlName<font size=3 color="#333399">(</font><font color="#ff00bf">"acc"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">-</font><font color="#333399">&gt;</font>addToolButton<font size=3 color="#333399">(</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Add new accountable..."</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    HDialog <font size=3 color="#333399">*</font>d <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> HDialog<font size=3 color="#333399">(</font>wstack<font size=3 color="#333399">.</font>top<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"New object"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>objt<font size=3 color="#333399">,</font>NULL<font size=3 color="#333399">,</font>
                             <font color="#ff00bf">"Ok|EscC|Vert|OkIsAccept|StrToE"</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Add a new object"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#ff00bf">""</font><font size=3 color="#333399">,</font><font color="#ff00bf">""</font><font size=3 color="#333399">,</font>NULL<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    wstack<font size=3 color="#333399">.</font>push_back<font size=3 color="#333399">(</font>d<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>while</font></b><font size=3 color="#333399">(</font>d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>exec<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        <font color="#553399"><b>bool</font></b> ok<font size=3 color="#333399">=</font><font color="#553399"><b>true</font></b><font size=3 color="#333399">;</font>
        objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>rereadNextInsertedKey<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>transaction<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>insertRecord<font size=3 color="#333399">(</font><font color="#553399"><b>false</font></b><font size=3 color="#333399">,</font><font color="#553399"><b>true</font></b><font size=3 color="#333399">,</font><font color="#553399"><b>false</font></b><font size=3 color="#333399">)</font> <font size=3 color="#333399">!</font><font size=3 color="#333399">=</font> <font color="c30000"><b>0</font></b><font size=3 color="#333399">)</font>
            ok <font size=3 color="#333399">=</font> <font color="#553399"><b>false</font></b><font size=3 color="#333399">;</font>
        <font color="#007766">//save the next prepository number
</font>
        globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit0ResultQuery<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">(</font><font color="#ff00bf">"UPDATE settings SET next=%1;"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>nextrepnum<font size=3 color="#333399">+</font><font color="c30000"><b>1</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Error set next rep num."</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>true</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>errorStatus<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
            ok <font size=3 color="#333399">=</font> <font color="#553399"><b>false</font></b><font size=3 color="#333399">;</font>
        <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>ok<font size=3 color="#333399">)</font>
        <font size=3 color="#333399">{</font>
            objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>commit<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
            HRefreshAgent<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>notify<font size=3 color="#333399">(</font><font color="#ff00bf">"object"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
            <font color="#553399"><b>break</font></b><font size=3 color="#333399">;</font>
        <font size=3 color="#333399">}</font>
        <font color="#553399"><b>else</font></b>
        <font size=3 color="#333399">{</font>
            objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>rollback<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
            <font color="#553399"><b>continue</font></b><font size=3 color="#333399">;</font>
        <font size=3 color="#333399">}</font>
    <font size=3 color="#333399">}</font>
    wstack<font size=3 color="#333399">.</font>pop<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> d<font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> objt<font size=3 color="#333399">;</font>
    objt <font size=3 color="#333399">=</font> NULL<font size=3 color="#333399">;</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>toolbuttonclicked<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>objt <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> NULL<font size=3 color="#333399">)</font>
        <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font> <font size=3 color="#333399">(</font><font size=3 color="#333399">(</font>HSqlChoose <font size=3 color="#333399">*</font><font size=3 color="#333399">)</font>objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>fieldBySqlName<font size=3 color="#333399">(</font><font color="#ff00bf">"type"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">-</font><font color="#333399">&gt;</font>toolbarbutton_down_text <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Add new type..."</font><font size=3 color="#333399">)</font> <font size=3 color="#333399">)</font>
        <font color="#553399"><b>return</font></b> slotAddTypes<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font> <font size=3 color="#333399">(</font><font size=3 color="#333399">(</font>HSqlChoose <font size=3 color="#333399">*</font><font size=3 color="#333399">)</font>objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>fieldBySqlName<font size=3 color="#333399">(</font><font color="#ff00bf">"place"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">-</font><font color="#333399">&gt;</font>toolbarbutton_down_text <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Add new place..."</font><font size=3 color="#333399">)</font> <font size=3 color="#333399">)</font>
        <font color="#553399"><b>return</font></b> slotAddPlaces<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font> <font size=3 color="#333399">(</font><font size=3 color="#333399">(</font>HSqlChoose <font size=3 color="#333399">*</font><font size=3 color="#333399">)</font>objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>fieldBySqlName<font size=3 color="#333399">(</font><font color="#ff00bf">"acc"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">-</font><font color="#333399">&gt;</font>toolbarbutton_down_text <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Add new accountable..."</font><font size=3 color="#333399">)</font> <font size=3 color="#333399">)</font>
        <font color="#553399"><b>return</font></b> slotAddAcc<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#007766">//Object list dialog
</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>objectList<font size=3 color="#333399">(</font>QString role<font size=3 color="#333399">,</font>QString mode<font size=3 color="#333399">,</font>QString filter<font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    QString caption<font size=3 color="#333399">=</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Objects"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>text<font size=3 color="#333399">=</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Objects"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    QString readfilter<font size=3 color="#333399">=</font><font color="#ff00bf">""</font><font size=3 color="#333399">;</font>
    currList <font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>genHList<font size=3 color="#333399">(</font><font color="#ff00bf">"Object"</font><font size=3 color="#333399">,</font>role<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    currList<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>extrafeatures <font size=3 color="#333399">=</font> <font color="#553399"><b>true</font></b><font size=3 color="#333399">;</font>

    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>mode <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> <font color="#ff00bf">"baselist"</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        connect<font size=3 color="#333399">(</font>currList<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>actionOnRecord<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotViewObject<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>mode <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> <font color="#ff00bf">"modify"</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        text <font size=3 color="#333399">=</font> tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Select object to modify"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        readfilter <font size=3 color="#333399">=</font> <font color="#ff00bf">" AND status=\'a\' "</font><font size=3 color="#333399">;</font>
        connect<font size=3 color="#333399">(</font>currList<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>actionOnRecord<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotModifyObject<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>mode <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> <font color="#ff00bf">"setcval"</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        text <font size=3 color="#333399">=</font> tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Select object to modify current value"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        readfilter <font size=3 color="#333399">=</font> <font color="#ff00bf">" AND status=\'a\' "</font><font size=3 color="#333399">;</font>
        connect<font size=3 color="#333399">(</font>currList<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>actionOnRecord<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotSetCValueObject<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>

    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>mode <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> <font color="#ff00bf">"out"</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        text <font size=3 color="#333399">=</font> tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Select object to sold/refuse"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        readfilter <font size=3 color="#333399">=</font> <font color="#ff00bf">" AND status=\'a\' "</font><font size=3 color="#333399">;</font>
        connect<font size=3 color="#333399">(</font>currList<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>actionOnRecord<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotOutObject<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>mode <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> <font color="#ff00bf">"trace"</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        text <font size=3 color="#333399">=</font> tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Select object to trace"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        connect<font size=3 color="#333399">(</font>currList<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>actionOnRecord<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotTraceObject<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>mode <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> <font color="#ff00bf">"place"</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        text <font size=3 color="#333399">=</font> tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Objects is in this place"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        connect<font size=3 color="#333399">(</font>currList<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>actionOnRecord<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotViewObject<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        readfilter <font size=3 color="#333399">=</font> QString<font size=3 color="#333399">(</font><font color="#ff00bf">" AND place=\'%1\' "</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>filter<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>mode <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> <font color="#ff00bf">"type"</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        text <font size=3 color="#333399">=</font> tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Objects is in type"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        connect<font size=3 color="#333399">(</font>currList<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>actionOnRecord<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotViewObject<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        readfilter <font size=3 color="#333399">=</font> QString<font size=3 color="#333399">(</font><font color="#ff00bf">" AND type=\'%1\' "</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>filter<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>mode <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> <font color="#ff00bf">"acc"</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        text <font size=3 color="#333399">=</font> tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Objects which assigned to this accountable"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        connect<font size=3 color="#333399">(</font>currList<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>actionOnRecord<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotViewObject<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        readfilter <font size=3 color="#333399">=</font> QString<font size=3 color="#333399">(</font><font color="#ff00bf">" AND acc=\'%1\' "</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>filter<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>

    HDialog <font size=3 color="#333399">*</font>d <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> HDialog<font size=3 color="#333399">(</font>wstack<font size=3 color="#333399">.</font>top<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>caption<font size=3 color="#333399">,</font>currList<font size=3 color="#333399">,</font>NULL<font size=3 color="#333399">,</font>
                             <font color="#ff00bf">"Ok|EscC|Vert"</font><font size=3 color="#333399">,</font>text<font size=3 color="#333399">,</font><font color="#ff00bf">""</font><font size=3 color="#333399">,</font><font color="#ff00bf">""</font><font size=3 color="#333399">,</font>NULL<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    currList<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>readList<font size=3 color="#333399">(</font>readfilter<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    wstack<font size=3 color="#333399">.</font>push_back<font size=3 color="#333399">(</font>d<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    connect<font size=3 color="#333399">(</font>currList<font size=3 color="#333399">,</font>SIGNAL<font size=3 color="#333399">(</font>alternateActionOnRecord<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotAlterOnObj<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>exec<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    wstack<font size=3 color="#333399">.</font>pop<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> d<font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> currList<font size=3 color="#333399">;</font>
    currList <font size=3 color="#333399">=</font> NULL<font size=3 color="#333399">;</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#007766">//Activate on right click on an object in object list
</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotAlterOnObj<font size=3 color="#333399">(</font>QString key<font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    QMenu <font size=3 color="#333399">*</font>popup <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> QMenu<font size=3 color="#333399">(</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    popup<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>addAction<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Add new object"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotInObj<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    popup<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>addAction<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Move/Edit object"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotMenuEdit<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    popup<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>addAction<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Sold/Refuse object"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotMenuRefuse<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    popup<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>addAction<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Trace object"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>SLOT<font size=3 color="#333399">(</font>slotMenuTrace<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    clicked_outkey <font size=3 color="#333399">=</font> key<font size=3 color="#333399">;</font>
    popup<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>exec<font size=3 color="#333399">(</font>QCursor<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>pos<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    clicked_outkey <font size=3 color="#333399">=</font> <font color="#ff00bf">""</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> popup<font size=3 color="#333399">;</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>objectViewEdit<font size=3 color="#333399">(</font>QString key<font size=3 color="#333399">,</font>QString role<font size=3 color="#333399">,</font><font color="#553399"><b>bool</font></b> readonly<font size=3 color="#333399">)</font> <font color="#007766">//View/Edit an object
</font>
<font size=3 color="#333399">{</font>
    <font color="#553399"><b>bool</font></b> ro <font size=3 color="#333399">=</font> readonly<font size=3 color="#333399">;</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>key<font size=3 color="#333399">.</font>isEmpty<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
        <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>

    <font color="#007766">//Generate the metadata object
</font>
    objt <font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>genHTable<font size=3 color="#333399">(</font><font color="#ff00bf">"Object"</font><font size=3 color="#333399">,</font>role<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    <font color="#007766">//Set logger
</font>
    objectchangelogger<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>setPos<font size=3 color="#333399">(</font><font color="#ff00bf">"slotViewEditObject"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>setDataChangeLogger<font size=3 color="#333399">(</font>objectchangelogger<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    <font color="#007766">//Read the data from SQL
</font>
    objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>updateWithKey<font size=3 color="#333399">(</font>key<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    <font color="#007766">//Set readonly if necessary (ro requested, or sold item)
</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>getSqlFieldValue<font size=3 color="#333399">(</font><font color="#ff00bf">"status"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>toString<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font> <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> <font color="#ff00bf">"o"</font><font size=3 color="#333399">)</font>
        ro <font size=3 color="#333399">=</font> <font color="#553399"><b>true</font></b><font size=3 color="#333399">;</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>ro<font size=3 color="#333399">)</font>
        objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>setReadonly<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>role <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> <font color="#ff00bf">"out"</font><font size=3 color="#333399">)</font>
        objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>setSqlFieldValue<font size=3 color="#333399">(</font><font color="#ff00bf">"status"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"o"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    <font color="#007766">//Check if allow empty accountable
</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font><font size=3 color="#333399">!</font>globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit1ResultQuery<font size=3 color="#333399">(</font><font color="#ff00bf">"SELECT allowemptyacc FROM settings LIMIT 1"</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Error query next settings"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>toBool<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
        objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>fieldBySqlName<font size=3 color="#333399">(</font><font color="#ff00bf">"acc"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">-</font><font color="#333399">&gt;</font>addNotValidValue<font size=3 color="#333399">(</font><font color="#ff00bf">"NULL"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    <font size=3 color="#333399">(</font><font size=3 color="#333399">(</font>HSqlChoose <font size=3 color="#333399">*</font><font size=3 color="#333399">)</font>objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>fieldBySqlName<font size=3 color="#333399">(</font><font color="#ff00bf">"type"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">-</font><font color="#333399">&gt;</font>addToolButton<font size=3 color="#333399">(</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Add new type..."</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">(</font><font size=3 color="#333399">(</font>HSqlChoose <font size=3 color="#333399">*</font><font size=3 color="#333399">)</font>objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>fieldBySqlName<font size=3 color="#333399">(</font><font color="#ff00bf">"place"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">-</font><font color="#333399">&gt;</font>addToolButton<font size=3 color="#333399">(</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Add new place..."</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">(</font><font size=3 color="#333399">(</font>HSqlChoose <font size=3 color="#333399">*</font><font size=3 color="#333399">)</font>objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>fieldBySqlName<font size=3 color="#333399">(</font><font color="#ff00bf">"acc"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">-</font><font color="#333399">&gt;</font>addToolButton<font size=3 color="#333399">(</font><font color="#553399"><b>this</font></b><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Add new accountable..."</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    HDialog <font size=3 color="#333399">*</font>d <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> HDialog<font size=3 color="#333399">(</font>wstack<font size=3 color="#333399">.</font>top<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Object"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>objt<font size=3 color="#333399">,</font>NULL<font size=3 color="#333399">,</font>
                             <font color="#ff00bf">"Ok|EscC|Vert|OkIsAccept|StrToE"</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Object's data"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font><font color="#ff00bf">""</font><font size=3 color="#333399">,</font><font color="#ff00bf">""</font><font size=3 color="#333399">,</font>NULL<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    wstack<font size=3 color="#333399">.</font>push_back<font size=3 color="#333399">(</font>d<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>while</font></b><font size=3 color="#333399">(</font>d<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>exec<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>ro<font size=3 color="#333399">)</font>
            <font color="#553399"><b>break</font></b><font size=3 color="#333399">;</font>
        <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>role <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> <font color="#ff00bf">"setcval"</font><font size=3 color="#333399">)</font>
            objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>setSqlFieldValue<font size=3 color="#333399">(</font><font color="#ff00bf">"lcdate"</font><font size=3 color="#333399">,</font>QDate<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>currentDate<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>objt<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>saveRecord<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font> <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> <font color="c30000"><b>0</font></b><font size=3 color="#333399">)</font>
        <font size=3 color="#333399">{</font>
            HRefreshAgent<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>notify<font size=3 color="#333399">(</font><font color="#ff00bf">"object"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
            <font color="#553399"><b>break</font></b><font size=3 color="#333399">;</font>
        <font size=3 color="#333399">}</font>
        <font color="#553399"><b>else</font></b> <font color="#553399"><b>continue</font></b><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>
    wstack<font size=3 color="#333399">.</font>pop<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> d<font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> objt<font size=3 color="#333399">;</font>
    objectchangelogger<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>setPos<font size=3 color="#333399">(</font><font color="#ff00bf">"Unknown"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    objt <font size=3 color="#333399">=</font> NULL<font size=3 color="#333399">;</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#007766">// //Trace an object changes //////////////////////////////////////////////////////////////////
</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotTraceObject<font size=3 color="#333399">(</font>QString key<font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    <font color="#553399"><b>int</font></b> i<font size=3 color="#333399">,</font>c<font size=3 color="#333399">;</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>key<font size=3 color="#333399">.</font>isEmpty<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
        <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>

    HDataField <font size=3 color="#333399">*</font>df<font size=3 color="#333399">;</font>
    HTable <font size=3 color="#333399">*</font>ot <font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>genHTable<font size=3 color="#333399">(</font><font color="#ff00bf">"Object"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    ot<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>updateWithKey<font size=3 color="#333399">(</font>key<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    HPlainDataMatrix <font size=3 color="#333399">*</font>m<font size=3 color="#333399">;</font>
    m <font size=3 color="#333399">=</font> globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submitNResultQuery<font size=3 color="#333399">(</font><font color="c30000"><b>4</font></b><font size=3 color="#333399">,</font>
            QString<font size=3 color="#333399">(</font><font color="#ff00bf">"SELECT sqlfieldname,oldvalue,newvalue,changetime FROM object_moving "</font>
                    <font color="#ff00bf">"WHERE changedkey=\'%1\' "</font>
                    <font color="#ff00bf">"ORDER BY changetime;"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>key<font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Error query changes"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    m<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>setHeaderCell<font size=3 color="#333399">(</font><font color="c30000"><b>0</font></b><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Changed data"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    m<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>setHeaderCell<font size=3 color="#333399">(</font><font color="c30000"><b>1</font></b><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Old value"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    m<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>setHeaderCell<font size=3 color="#333399">(</font><font color="c30000"><b>2</font></b><font size=3 color="#333399">,</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"New value"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    c <font size=3 color="#333399">=</font> m<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>rowCount<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>for</font></b><font size=3 color="#333399">(</font>i<font size=3 color="#333399">=</font><font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>i<font color="#333399">&lt;</font>c<font size=3 color="#333399">;</font><font size=3 color="#333399">+</font><font size=3 color="#333399">+</font>i<font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        df <font size=3 color="#333399">=</font> ot<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>fieldBySqlName<font size=3 color="#333399">(</font>m<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>getCellStr<font size=3 color="#333399">(</font>i<font size=3 color="#333399">,</font><font color="c30000"><b>0</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>df <font size=3 color="#333399">!</font><font size=3 color="#333399">=</font> NULL<font size=3 color="#333399">)</font>
        <font size=3 color="#333399">{</font>
            QString explain_txt<font size=3 color="#333399">=</font><font color="#ff00bf">""</font><font size=3 color="#333399">;</font>
            QString old_display_str<font size=3 color="#333399">=</font><font color="#ff00bf">""</font><font size=3 color="#333399">;</font>
            QString new_display_str<font size=3 color="#333399">=</font><font color="#ff00bf">""</font><font size=3 color="#333399">;</font>

            explain_txt <font size=3 color="#333399">=</font> df<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>getExplainText<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
            old_display_str <font size=3 color="#333399">=</font> df<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>dbValueToDispValue<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">(</font>m<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>getCellStr<font size=3 color="#333399">(</font>i<font size=3 color="#333399">,</font><font color="c30000"><b>1</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>toString<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
            new_display_str <font size=3 color="#333399">=</font> df<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>dbValueToDispValue<font size=3 color="#333399">(</font>QString<font size=3 color="#333399">(</font>m<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>getCellStr<font size=3 color="#333399">(</font>i<font size=3 color="#333399">,</font><font color="c30000"><b>2</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>toString<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

            <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font><font size=3 color="#333399">!</font>explain_txt<font size=3 color="#333399">.</font>isEmpty<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
                m<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>setCellStr<font size=3 color="#333399">(</font>i<font size=3 color="#333399">,</font><font color="c30000"><b>0</font></b><font size=3 color="#333399">,</font>explain_txt<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
            <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font><font size=3 color="#333399">!</font>old_display_str<font size=3 color="#333399">.</font>isEmpty<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
                m<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>setCellStr<font size=3 color="#333399">(</font>i<font size=3 color="#333399">,</font><font color="c30000"><b>1</font></b><font size=3 color="#333399">,</font>old_display_str<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
            <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font><font size=3 color="#333399">!</font>new_display_str<font size=3 color="#333399">.</font>isEmpty<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
                m<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>setCellStr<font size=3 color="#333399">(</font>i<font size=3 color="#333399">,</font><font color="c30000"><b>2</font></b><font size=3 color="#333399">,</font>new_display_str<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        <font size=3 color="#333399">}</font>
    <font size=3 color="#333399">}</font>

    HPlainDMD <font size=3 color="#333399">*</font>pdmd <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> HPlainDMD<font size=3 color="#333399">(</font>wstack<font size=3 color="#333399">.</font>top<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">,</font>m<font size=3 color="#333399">,</font><font color="#553399"><b>true</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    pdmd<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>exec<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> pdmd<font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> m<font size=3 color="#333399">;</font>
    <font color="#553399"><b>delete</font></b> ot<font size=3 color="#333399">;</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#007766">// Small slots for events //////////////////////////////////////////////////////////////////////////
</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotViewObject<font size=3 color="#333399">(</font>QString key<font size=3 color="#333399">)</font>     <font size=3 color="#333399">{</font>    <font color="#553399"><b>return</font></b> objectViewEdit<font size=3 color="#333399">(</font>key<font size=3 color="#333399">,</font><font color="#ff00bf">""</font><font size=3 color="#333399">,</font><font color="#553399"><b>true</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>        <font size=3 color="#333399">}</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotModifyObject<font size=3 color="#333399">(</font>QString key<font size=3 color="#333399">)</font>   <font size=3 color="#333399">{</font>    <font color="#553399"><b>return</font></b> objectViewEdit<font size=3 color="#333399">(</font>key<font size=3 color="#333399">,</font><font color="#ff00bf">"modify"</font><font size=3 color="#333399">,</font><font color="#553399"><b>false</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font> <font size=3 color="#333399">}</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotSetCValueObject<font size=3 color="#333399">(</font>QString key<font size=3 color="#333399">)</font><font size=3 color="#333399">{</font>    <font color="#553399"><b>return</font></b> objectViewEdit<font size=3 color="#333399">(</font>key<font size=3 color="#333399">,</font><font color="#ff00bf">"setcval"</font><font size=3 color="#333399">,</font><font color="#553399"><b>false</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font><font size=3 color="#333399">}</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotOutObject<font size=3 color="#333399">(</font>QString key<font size=3 color="#333399">)</font>      <font size=3 color="#333399">{</font>    <font color="#553399"><b>return</font></b> objectViewEdit<font size=3 color="#333399">(</font>key<font size=3 color="#333399">,</font><font color="#ff00bf">"out"</font><font size=3 color="#333399">,</font><font color="#553399"><b>false</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>    <font size=3 color="#333399">}</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotMenuEdit<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>              <font size=3 color="#333399">{</font>    <font color="#553399"><b>return</font></b> objectViewEdit<font size=3 color="#333399">(</font>clicked_outkey<font size=3 color="#333399">,</font><font color="#ff00bf">"modify"</font><font size=3 color="#333399">,</font><font color="#553399"><b>false</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>  <font size=3 color="#333399">}</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotMenuRefuse<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>            <font size=3 color="#333399">{</font>    <font color="#553399"><b>return</font></b> objectViewEdit<font size=3 color="#333399">(</font>clicked_outkey<font size=3 color="#333399">,</font><font color="#ff00bf">"out"</font><font size=3 color="#333399">,</font><font color="#553399"><b>false</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>     <font size=3 color="#333399">}</font>

<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotPlacesAct<font size=3 color="#333399">(</font>QString key<font size=3 color="#333399">)</font>      <font size=3 color="#333399">{</font>    <font color="#553399"><b>return</font></b> objectList<font size=3 color="#333399">(</font><font color="#ff00bf">"list"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"place"</font><font size=3 color="#333399">,</font>key<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>     <font size=3 color="#333399">}</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotTypesAct<font size=3 color="#333399">(</font>QString key<font size=3 color="#333399">)</font>       <font size=3 color="#333399">{</font>    <font color="#553399"><b>return</font></b> objectList<font size=3 color="#333399">(</font><font color="#ff00bf">"list"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"type"</font><font size=3 color="#333399">,</font>key<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>      <font size=3 color="#333399">}</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotAccAct<font size=3 color="#333399">(</font>QString key<font size=3 color="#333399">)</font>         <font size=3 color="#333399">{</font>    <font color="#553399"><b>return</font></b> objectList<font size=3 color="#333399">(</font><font color="#ff00bf">"list"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"acc"</font><font size=3 color="#333399">,</font>key<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>       <font size=3 color="#333399">}</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotObjects<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>               <font size=3 color="#333399">{</font>    <font color="#553399"><b>return</font></b> objectList<font size=3 color="#333399">(</font><font color="#ff00bf">"list"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"baselist"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>      <font size=3 color="#333399">}</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotMoveObj<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>               <font size=3 color="#333399">{</font>    <font color="#553399"><b>return</font></b> objectList<font size=3 color="#333399">(</font><font color="#ff00bf">"list"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"modify"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>        <font size=3 color="#333399">}</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotSetCValueObj<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>          <font size=3 color="#333399">{</font>    <font color="#553399"><b>return</font></b> objectList<font size=3 color="#333399">(</font><font color="#ff00bf">"list"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"setcval"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>       <font size=3 color="#333399">}</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotOutObj<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>                <font size=3 color="#333399">{</font>    <font color="#553399"><b>return</font></b> objectList<font size=3 color="#333399">(</font><font color="#ff00bf">"list"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"out"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>           <font size=3 color="#333399">}</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotTraceObj<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>              <font size=3 color="#333399">{</font>    <font color="#553399"><b>return</font></b> objectList<font size=3 color="#333399">(</font><font color="#ff00bf">"list"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"trace"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>         <font size=3 color="#333399">}</font>

<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotMenuTrace<font size=3 color="#333399">(</font><font color="#553399"><b>void</font></b><font size=3 color="#333399">)</font>             <font size=3 color="#333399">{</font>    <font color="#553399"><b>return</font></b> slotTraceObject<font size=3 color="#333399">(</font>clicked_outkey<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>    <font size=3 color="#333399">}</font>

<font color="#007766">// //Small statistics///////////////////////////////////////////////////////////////////
</font>
<font color="#553399"><b>int</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>slotStat<font size=3 color="#333399">(</font>QString tblname<font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    Q_UNUSED<font size=3 color="#333399">(</font>tblname<font size=3 color="#333399">)</font>
    <font color="#553399"><b>int</font></b> pnum <font size=3 color="#333399">=</font> globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit1ResultQuery<font size=3 color="#333399">(</font><font color="#ff00bf">"SELECT count(*) FROM place;"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"S_E1"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>toInt<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>int</font></b> anum <font size=3 color="#333399">=</font> globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit1ResultQuery<font size=3 color="#333399">(</font><font color="#ff00bf">"SELECT count(*) FROM accountable;"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"S_E2"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>toInt<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>int</font></b> tnum <font size=3 color="#333399">=</font> globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit1ResultQuery<font size=3 color="#333399">(</font><font color="#ff00bf">"SELECT count(*) FROM type;"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"S_E3"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>toInt<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>int</font></b> onum <font size=3 color="#333399">=</font> globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit1ResultQuery<font size=3 color="#333399">(</font><font color="#ff00bf">"SELECT count(*) FROM object;"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"S_E4"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>toInt<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>int</font></b> oanum <font size=3 color="#333399">=</font> globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit1ResultQuery<font size=3 color="#333399">(</font><font color="#ff00bf">"SELECT count(*) FROM object WHERE status=\'a\';"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"S_E5"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>toInt<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>double</font></b> osum <font size=3 color="#333399">=</font> globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit1ResultQuery<font size=3 color="#333399">(</font><font color="#ff00bf">"SELECT sum(invalue) FROM object;"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"S_E6"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>toDouble<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>double</font></b> oasum <font size=3 color="#333399">=</font> globalsql<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>submit1ResultQuery<font size=3 color="#333399">(</font><font color="#ff00bf">"SELECT sum(invalue) FROM object WHERE status=\'a\';"</font><font size=3 color="#333399">,</font><font color="#ff00bf">"S_E7"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>toDouble<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    ui<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>label<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>setText<font size=3 color="#333399">(</font>
            QString<font size=3 color="#333399">(</font><font color="#ff00bf">"%1: %2  (%3: %4)\n%5: %6  (%7: %8)\n%9: %10\n%11: %12\n%13: %14"</font><font size=3 color="#333399">)</font>
                <font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Objects in the system"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>onum<font size=3 color="#333399">)</font>
                <font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Active"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>oanum<font size=3 color="#333399">)</font>
                <font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Sum incoming value in the system"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>osum<font size=3 color="#333399">)</font>
                <font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Active"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>oasum<font size=3 color="#333399">)</font>
                <font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Types in the system"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>tnum<font size=3 color="#333399">)</font>
                <font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Places in the system"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font><font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>doubleToQString<font size=3 color="#333399">(</font>pnum<font size=3 color="#333399">,</font><font color="c30000"><b>0</font></b><font size=3 color="#333399">,</font><font color="c30000"><b>2</font></b><font size=3 color="#333399">,</font><font color="c30000"><b>1</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
                <font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font>tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Accountables in the system"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font><font size=3 color="#333399">.</font>arg<font size=3 color="#333399">(</font><font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>doubleToQString<font size=3 color="#333399">(</font>anum<font size=3 color="#333399">,</font><font color="c30000"><b>0</font></b><font size=3 color="#333399">,</font><font color="c30000"><b>2</font></b><font size=3 color="#333399">,</font><font color="c30000"><b>1</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
            <font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#007766">// //Other//////////////////////////////////////////////////////////////////////////////
</font>
<font color="#553399"><b>void</font></b> MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>keyPressEvent<font size=3 color="#333399">(</font>QKeyEvent <font size=3 color="#333399">*</font>e<font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>e<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>key<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font> <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> Qt<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>Key_Escape<font size=3 color="#333399">)</font>
        close<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

QString MainDialog<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>donsole_command_interpreter<font size=3 color="#333399">(</font>QString commandString<font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>commandString <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> <font color="#ff00bf">"createstr"</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        QString createstr<font size=3 color="#333399">=</font><font color="#ff00bf">"=========================================================\n"</font><font size=3 color="#333399">;</font>
        createstr <font size=3 color="#333399">+</font><font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>sqlCreateString<font size=3 color="#333399">(</font><font color="#ff00bf">"settings"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>    createstr<font size=3 color="#333399">.</font>append<font size=3 color="#333399">(</font><font color="#ff00bf">"\n"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        createstr <font size=3 color="#333399">+</font><font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>sqlCreateString<font size=3 color="#333399">(</font><font color="#ff00bf">"Type"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>        createstr<font size=3 color="#333399">.</font>append<font size=3 color="#333399">(</font><font color="#ff00bf">"\n"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        createstr <font size=3 color="#333399">+</font><font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>sqlCreateString<font size=3 color="#333399">(</font><font color="#ff00bf">"Place"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>       createstr<font size=3 color="#333399">.</font>append<font size=3 color="#333399">(</font><font color="#ff00bf">"\n"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        createstr <font size=3 color="#333399">+</font><font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>sqlCreateString<font size=3 color="#333399">(</font><font color="#ff00bf">"Accountable"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font> createstr<font size=3 color="#333399">.</font>append<font size=3 color="#333399">(</font><font color="#ff00bf">"\n"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        createstr <font size=3 color="#333399">+</font><font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>sqlCreateString<font size=3 color="#333399">(</font><font color="#ff00bf">"Object"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>      createstr<font size=3 color="#333399">.</font>append<font size=3 color="#333399">(</font><font color="#ff00bf">"\n"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        createstr <font size=3 color="#333399">+</font><font size=3 color="#333399">=</font> myfactory<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>sqlCreateString<font size=3 color="#333399">(</font><font color="#ff00bf">"Moving"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>      createstr<font size=3 color="#333399">.</font>append<font size=3 color="#333399">(</font><font color="#ff00bf">"\n"</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        <font color="#553399"><b>return</font></b> createstr<font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>
    <font color="#553399"><b>if</font></b><font size=3 color="#333399">(</font>commandString <font size=3 color="#333399">=</font><font size=3 color="#333399">=</font> <font color="#ff00bf">"dumpmetadata"</font><font size=3 color="#333399">)</font>
    <font size=3 color="#333399">{</font>
        QFile f<font size=3 color="#333399">(</font>METADEFFILE<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        <font color="#553399"><b>if</font></b> <font size=3 color="#333399">(</font><font size=3 color="#333399">!</font>f<font size=3 color="#333399">.</font>open<font size=3 color="#333399">(</font>QIODevice<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>ReadOnly <font size=3 color="#333399">|</font> QIODevice<font size=3 color="#333399">:</font><font size=3 color="#333399">:</font>Text<font size=3 color="#333399">)</font><font size=3 color="#333399">)</font>
            <font color="#553399"><b>return</font></b> tr<font size=3 color="#333399">(</font><font color="#ff00bf">"Error, cannot provide the resource."</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        QTextStream in<font size=3 color="#333399">(</font><font size=3 color="#333399">&</font>f<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
        <font color="#553399"><b>return</font></b> in<font size=3 color="#333399">.</font>readAll<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font size=3 color="#333399">}</font>
    <font color="#553399"><b>return</font></b> <font color="#ff00bf">"Ok."</font><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>

<font color="#007766">// //////////////////////////////////////////////////////////////////////////// //
</font>

<font color="#553399"><b>int</font></b> main<font size=3 color="#333399">(</font><font color="#553399"><b>int</font></b> argi<font size=3 color="#333399">,</font><font color="#553399"><b>char</font></b> <font size=3 color="#333399">*</font><font size=3 color="#333399">*</font>argc<font size=3 color="#333399">)</font>
<font size=3 color="#333399">{</font>
    QApplication app<font size=3 color="#333399">(</font>argi<font size=3 color="#333399">,</font>argc<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

<font color="#c300c3">#ifdef </font>LANG_HU
    QTranslator qtTranslator<font size=3 color="#333399">;</font>
    qtTranslator<font size=3 color="#333399">.</font>load<font size=3 color="#333399">(</font>LANGUAGEFILE<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    app<font size=3 color="#333399">.</font>installTranslator<font size=3 color="#333399">(</font><font size=3 color="#333399">&</font>qtTranslator<font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
<font color="#c300c3">#endif
</font>
    MainDialog <font size=3 color="#333399">*</font>maindialog <font size=3 color="#333399">=</font> <font color="#553399"><b>new</font></b> MainDialog<font size=3 color="#333399">(</font><font color="c30000"><b>0</font></b><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    maindialog<font size=3 color="#333399">-</font><font color="#333399">&gt;</font>show<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>

    app<font size=3 color="#333399">.</font>exec<font size=3 color="#333399">(</font><font size=3 color="#333399">)</font><font size=3 color="#333399">;</font>
    <font color="#553399"><b>return</font></b> <font color="c30000"><b>0</font></b><font size=3 color="#333399">;</font>
<font size=3 color="#333399">}</font>
<font color="#007766">//end code.
</font>

</pre>
</td></tr></table>
</center>
</body>
</html>
